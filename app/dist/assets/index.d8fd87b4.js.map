{"version":3,"file":"index.d8fd87b4.js","sources":["../../vite/modulepreload-polyfill","../../main.js"],"sourcesContent":["const p = function polyfill() {\n    const relList = document.createElement('link').relList;\n    if (relList && relList.supports && relList.supports('modulepreload')) {\n        return;\n    }\n    for (const link of document.querySelectorAll('link[rel=\"modulepreload\"]')) {\n        processPreload(link);\n    }\n    new MutationObserver((mutations) => {\n        for (const mutation of mutations) {\n            if (mutation.type !== 'childList') {\n                continue;\n            }\n            for (const node of mutation.addedNodes) {\n                if (node.tagName === 'LINK' && node.rel === 'modulepreload')\n                    processPreload(node);\n            }\n        }\n    }).observe(document, { childList: true, subtree: true });\n    function getFetchOpts(script) {\n        const fetchOpts = {};\n        if (script.integrity)\n            fetchOpts.integrity = script.integrity;\n        if (script.referrerpolicy)\n            fetchOpts.referrerPolicy = script.referrerpolicy;\n        if (script.crossorigin === 'use-credentials')\n            fetchOpts.credentials = 'include';\n        else if (script.crossorigin === 'anonymous')\n            fetchOpts.credentials = 'omit';\n        else\n            fetchOpts.credentials = 'same-origin';\n        return fetchOpts;\n    }\n    function processPreload(link) {\n        if (link.ep)\n            // ep marker = processed\n            return;\n        link.ep = true;\n        // prepopulate the load record\n        const fetchOpts = getFetchOpts(link);\n        fetch(link.href, fetchOpts);\n    }\n};__VITE_IS_MODERN__&&p();","import './style.css';\nimport {\n    Feature,\n    Map,\n    View,\n} from 'ol';\nimport OSM from 'ol/source/OSM';\nimport VectorSource from 'ol/source/Vector';\nimport Point from 'ol/geom/Point';\nimport {\n    fromLonLat,\n    useGeographic\n} from 'ol/proj';\nimport {\n    Heatmap as HeatmapLayer,\n    Tile as TileLayer,\n} from 'ol/layer';\n\nuseGeographic();\n\n\n// Loading the data\nconst parkingData = await fetch(\"data.json\")\n    .then(response => response.json())\n    .then(json => {\n        return json\n    });\nconsole.log(parkingData);\n\nlet startIndex = 0;\nlet endIndex = parkingData[\"Bezigrad\"].percent_occupied.length;\nlet i = startIndex;\n\n// Datepicker setup\n$('input[name=\"daterange\"]').daterangepicker({\n    locale: {\n        format: 'DD/MM/YYYY'\n    },\n    minDate: new Date(Math.min(...parkingData[\"Bezigrad\"].timestamps) * 1000),\n    maxDate: new Date(Math.max(...parkingData[\"Bezigrad\"].timestamps) * 1000),\n});\n\n$('input[name=\"daterange\"]').on('apply.daterangepicker', (ev, picker) => {\n    let startTime = Math.floor(picker.startDate._d.getTime() / 1000);\n    let endTime = Math.floor(picker.endDate._d.getTime() / 1000);\n\n    startIndex = -1;\n    endIndex = -1;\n    for (let idx = 0; idx < parkingData[\"Bezigrad\"].timestamps.length; idx++) {\n        console.log(idx);\n        if (startIndex == -1 && startTime <= parkingData[\"Bezigrad\"].timestamps[idx]) {\n            startIndex = idx;\n        }\n        if (endIndex == -1 && parkingData[\"Bezigrad\"].timestamps[idx] >= endTime) {\n            endIndex = idx;\n            break;\n        }\n    }\n    i = startIndex;\n    // console.log(startIndex, endIndex);\n});\n\nconst aSpeed = document.getElementById('speed');\nlet animationSpeed = 50;\nlet animationPlaying = false;\n$(\"#stop\").addClass(\"activeButton\");\n\n\n// Adding initial parking data\nlet data = new VectorSource();\n\ndata.addFeature(new Feature({\n    name: \"MAX\",\n    geometry: new Point(fromLonLat([0, 0, 0])),\n    magnitude: 1,\n}));\n\nconst parkingCoords = [\n    [14.517521, 46.039284, \"Dolenjska cesta (Strelisce)\"],\n    [14.508285, 46.062497, \"Bezigrad\"],\n    [14.514254, 46.087035, \"BS4/ I\"],\n    [14.514251, 46.086728, \"BS4/ II\"],\n    [14.518000, 46.074537, \"Gosarjeva ulica\"],\n    [14.515989, 46.074583, \"Gosarjeva ulica II.\"],\n    [14.510116, 46.061856, \"Gospodarsko razstavisce\"],\n    // [14.513173, 46.088353, \"Komanova ulica\"],\n    [14.503415, 46.050617, \"PH Kongresni trg\"],\n    [14.504961, 46.056943, \"Kozolec\"],\n    [14.522073, 46.070205, \"Kranjceva ulica\"],\n    [14.509180, 46.063127, \"Linhartova\"],\n    [14.516126, 46.056973, \"Metelkova ulica\"],\n    [14.494343, 46.046584, \"Mirje\"],\n    [14.501974, 46.046687, \"NUK II.\"],\n    //[14.499581, 46.026924, \"P+R Barje\"],\n    //[14.463085, 46.036492, \"P+R Dolgi most\"],\n    //[14.568027, 46.054279, \"P+R Studenec\"],\n    [14.493818, 46.042360, \"PH Kolezija\"],\n    [14.511568, 46.052130, \"Petkovskovo nabrezje II.\"],\n    [14.582565, 46.054942, \"Pokopalisce Polje\"],\n    [14.529375, 46.051250, \"Povsetova ulica\"],\n    [14.508596, 46.053622, \"Senatorij Emona\"],\n    [14.507321, 46.088504, \"Slovenceva ulica\"],\n    [14.500366, 46.056411, \"Tivoli I.\"],\n    [14.497231, 46.059912, \"Tivoli II.\"],\n    [14.495670, 46.046982, \"Trg mladinskih delovnih brigad\"],\n    [14.488943, 46.068388, \"Trg prekomorskih brigad\"],\n    // [14.515946, 46.078370, \"Stembalova ulica\"],\n    [14.528873, 46.068968, \"Zale I.\"],\n    [14.528680, 46.067131, \"Zale II.\"],\n    [14.526062, 46.067969, \"Zale III.\"],\n    [14.526815, 46.069497, \"Zale IV.\"],\n    [14.531361, 46.074782, \"Zale V.\"],\n]\nparkingCoords.forEach(parking => {\n    data.addFeature(new Feature({\n        name: parking[2],\n        geometry: new Point(fromLonLat([parking[0], parking[1], 0])),\n        magnitude: 0.0,\n    }));\n});\n\nconst vector = new HeatmapLayer({\n    source: data,\n    blur: 18,\n    radius: 20,\n    weight: (feature) => {\n        const name = feature.get('name');\n        const magnitude = feature.get('magnitude');\n        return magnitude;\n    },\n});\n\nconst raster = new TileLayer({\n    source: new OSM(),\n});\n\nconst map = new Map({\n    layers: [raster, vector],\n    target: 'map',\n    view: new View({\n        center: [14.505751, 46.056946],\n        zoom: 13,\n    }),\n});\n\n\n// Animation logic\nlet renderParkings = () => {\n    if (animationPlaying) {\n        data.forEachFeature(feat => {\n            let name = feat.getProperties().name;\n            if (name !== \"MAX\") {\n                let percent = parkingData[name].percent_occupied[i];\n                if (!(i < endIndex)) {\n                    animationPlaying = false;\n                    $(\"#play\").removeClass(\"activeButton\");\n                    $(\"#stop\").addClass(\"activeButton\");\n                }\n                feat.setProperties({\n                    magnitude: percent\n                });\n            }\n        });\n        map.render();\n        let time = new Date(parkingData[\"Bezigrad\"].timestamps[i] * 1000);\n\n        $(\"#currentTime\").html(`\n            <p>${time.toLocaleDateString()}</p>\n            <p>${time.toLocaleTimeString()}</p>\n        `);\n        // <p>${time.toLocaleDateString(\"sl-SL\", { weekday: 'long' })}</p>\n        i++;\n        // console.log(animationSpeed);\n        setTimeout(renderParkings, animationSpeed);\n    }\n}\n\n\n// UI handling\n$(\"#play\").click(() => {\n    if (!animationPlaying) {\n        animationPlaying = true;\n        setTimeout(renderParkings, animationSpeed);\n        $(\"#play\").addClass(\"activeButton\");\n        $(\"#stop\").removeClass(\"activeButton\");\n    }\n});\n$(\"#stop\").click(() => {\n    if (animationPlaying) {\n        animationPlaying = false;\n        $(\"#play\").removeClass(\"activeButton\");\n        $(\"#stop\").addClass(\"activeButton\");\n    }\n});\n\n\nconst animationSpeedHandler = () => {\n    animationSpeed = 500 - parseInt(aSpeed.value);\n};\naSpeed.addEventListener('input', animationSpeedHandler);\naSpeed.addEventListener('speed', animationSpeedHandler);"],"names":[],"mappings":"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"}